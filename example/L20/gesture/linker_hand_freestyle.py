#!/usr/bin/env python3
import sys, os, time
current_dir = os.path.dirname(os.path.abspath(__file__))
target_dir = os.path.abspath(os.path.join(current_dir, "../../.."))
sys.path.append(target_dir)
from LinkerHand.linker_hand_api import LinkerHandApi

'''
循环执行7个新的预设手部动作
'''
def main():
    hand = LinkerHandApi(hand_joint="L20", hand_type="left")
    #hand_r = LinkerHandApi(hand_joint="L10", hand_type="right")
    # 设置使能状态
    hand.set_enable()
    #hand_r.set_enable()
    time.sleep(0.1)
    # 设置速度
    hand.set_speed(speed=[240]*5)
    #hand_r.set_speed(speed=[240]*5)
    
    # 定义7个新的预设动作

    

    pose = [255, 128, 255, 255, 255, 255, 128, 128, 128, 128]
    #open_hand
    action1=[250, 250, 250, 250, 250, 250, 128, 128, 128, 128, 250, 0, 0, 0, 0, 250, 250, 250, 250, 250]
    #ring_little_shrink
    action2=[250,250,250, 0,  0, 250,128,128,128,128,250, 0, 0, 0, 0,250,250,250,  0, 0]#shrink stretch
    #show_yeah
    action3=[100,250,250, 0,  0, 180,128,128,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
    action4=[100,250,250, 0,  0, 180,200,200,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
    action5=[100,250,250, 0,  0, 180, 50, 50,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
    action6=[100,250,250, 0,  0, 180,128,128,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
    action7=[100,250,250, 0,  0, 180, 58,200,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
    action8=[100,250,250, 0,  0, 180,128,128,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
    #action9=[190, 20, 0, 25, 40, 255, 255, 150, 150, 150, 100, 255, 255, 255, 255, 150, 255, 255, 255, 255, 255, 255, 255, 255, 255]
    poses = []

    action9=[100,250,250, 0,  0, 180, 58,200,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
        #9): #// 收Y
    action10=[100,250,250, 0,  0, 180,128,128,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
#10): #// 中指和食指弯曲伸直交替两遍
    action11=[100,100,100, 0,  0, 180,128,128,128,128,200, 0, 0, 0, 0,  0,100,100,  0, 0]
#11): #// 中指和食指弯曲伸直交替两遍
    action12=[100,250,250, 0,  0, 180,128,128,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
#12): #// 中指和食指弯曲伸直交替两遍
    action13=[100,100,100, 0,  0, 180,128,128,128,128,200, 0, 0, 0, 0,  0,100,100,  0, 0]
#13): #// 中指和食指弯曲伸直交替两遍
    action14=[100,250,250, 0,  0, 180,128,128,128,128,200, 0, 0, 0, 0,  0,250,250,  0, 0]
#14): #// 蜷曲拇指
    action15=[250,250,250, 0,  0, 150,128,128,128,128,250, 0, 0, 0, 0,  0,250,250,  0, 0]
#15): #// 拇指收于掌内
    action16=[250,250,250, 0,  0,  5 ,128,128,128,128,250, 0, 0, 0, 0,  0,250,250,  0, 0]
#16): #// 收4指
    action17=[250,100,100,100,100, 5 ,128,128,128,128,250, 0, 0, 0, 0,  0,10, 10,  10, 10]
#17): #// 依次放开4指和拇指
    action18=[250,100,100,100,250, 5 ,128,128,128,128,250, 0, 0, 0, 0,  0,10, 10,  10, 250]
#18): #// 1
    action19=[250,100,100,250,250, 5 ,128,128,128,128,250, 0, 0, 0, 0,  0,10, 10,  250, 250]
#19): #// 2
    action20=[250,100,250,250,250, 5 ,128,128,128,128,250, 0, 0, 0, 0,  0,10, 250,  250, 250]
#20): #// 3
    action21=[250,250,250,250,250, 5 ,128,128,128,128,250, 0, 0, 0, 0,  0,250, 250,  250, 250]
#21): #// 4
    action22=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,250, 250,  250, 250]
#22): #// 并拢拇指
    action23=[250,250,250,250,250,250,128,128,128,128, 10, 0, 0, 0, 0, 250,250, 250,  250, 250]
#23): #// 反转拇指指掌心
    action24=[  0,250,250,250,250,250,128,128,128,128, 10, 0, 0, 0, 0, 250,250, 250,  250, 250]
#24): #// 分两步回到初始位置
    action25=[  0,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,250, 250,  250, 250]
#25): #// 1
    action26=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,250, 250,  250, 250]
#26): #// 2
    action27=[250,250,250,250,250,250,200,200,200,200,250, 0, 0, 0, 0, 250,250, 250,  250, 250]
#27): #// 3
    action28=[250,250,250,250,250,250, 80, 80, 80, 80,250, 0, 0, 0, 0, 250,250, 250,  250, 250]
#28): #// 4
    action29=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,250, 250,  250, 250]
#29): #// 依次蜷曲4小指
    action30=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0, 250,  250, 250]
#30): #// 蜷曲4指
    action31=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0,  0,  250, 250]
#31): #// 4
    action32=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0,  0,   0, 250]
#32): #// 4
    action33=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0,  0,   0,  0]
#33): #// 依次蜷曲4小指
    action34=[250,  0,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0,  0,   0,  0]
#34): #// 依次蜷曲4小指
    action35=[250,  0,  0,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0,  0,   0,  0]
#35): #// 依次蜷曲4小指
    action36=[250,  0,  0,  0,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0,  0,   0,  0]
#36): #// 依次蜷曲4小指
    action37=[250,  0,  0,  0,  0,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0,  0,   0,  0]
#37): #// 蜷曲拇指
    action38=[  0,  0,  0,  0,  0,250,128,128,128,128,250, 0, 0, 0, 0, 200,  0,  0,   0,  0]
#38): #// 打开食指和小指
    action39=[250,  0,  0,  0,  0,250,128,128,128,128,250, 0, 0, 0, 0, 250,  0,  0,   0,  0]
#39): #// 打开食指和小指
    action40=[250,250,  0,  0,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,250,  0,   0,250]
#40): #// 将拇指搭上666
    action41=[100,250,  0,  0,250,200,128,128,128,128,100, 0, 0, 0, 0,100,250,  0,   0,250]
#41): #// 左右动手指
    action42=[100,250,  0,  0,250,200, 80,128,128,200,100, 0, 0, 0, 0,100,250,  0,   0,250]
#42): #// 左右动手指
    action43=[100,250,  0,  0,250,200,200,128,128, 80,100, 0, 0, 0, 0,100,250,  0,   0,250]
#43): #// 左右动手指
    action44=[100,250,  0,  0,250,200, 80,128,128,200,100, 0, 0, 0, 0,100,250,  0,   0,250]
#44): #// 左右动手指
    action45=[100,250,  0,  0,250,200,200,128,128, 80,100, 0, 0, 0, 0,100,250,  0,   0,250]
#45): #// 左右动手指
    action46=[100,250,  0,  0,250,200,128,128,128,128,100, 0, 0, 0, 0,100,250,  0,   0,250]
#46): #//  展开
    action47=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0,250,250,250, 250,250]
#47): #// 拇指和食指捏
    action48=[ 55, 0,250,250,250,170,128,128,128,128,70, 0, 0, 0, 0,250,250,250, 250,250]
#48): #// 1
    action49=[250,250, 20,250,250,220,128,128,128,128,100, 0, 0, 0, 0,250,250,250, 250,250]
#49): #// 拇指和中指捏
    action50=[ 55,250, 0,250,250,140,128,128,128,128,60, 0, 0, 0, 0,250,250,250, 250,250]
#50): #// 1
    action51=[250,250,250, 20,250,170,128,128,128,128,100, 0, 0, 0, 0,250,250,250, 250,250]
#51): #// 拇指和无名指捏
    action52=[ 55,250,250, 0 ,250,110,128,128,128,128,50, 0, 0, 0, 0,250,250,250, 250,250]
#52): #// 1
    action53=[250,250,250,250, 20,130,128,128,128,128,100, 0, 0, 0, 0,250,250,250, 250,250]
#53): #// 拇指和小指捏
    action54=[ 55,250,250,250,  0, 60,128,128,128,128,50, 0, 0, 0, 0,250,250,250, 250,250]
#54): #// 1
    action55=[250,250,250,250, 20,130,128,128,128,128,100, 0, 0, 0, 0,250,250,250, 250,250]
#55): #// 拇指和小指掐
    action56=[160,250,250,250,160, 60,128,128,128,128,50, 0, 0, 0, 0,100,250,250, 250, 80]
#56): #// 1
    action57=[250,250,250,250,250,130,128,128,128,128,100, 0, 0, 0, 0,250,250,250,  50, 250]
#57): #// 拇指和无名指掐
    action58=[160,250,250,150,250,100,128,128,128,128,50, 0, 0, 0, 0,100,250,250, 80, 250]
#58): #// 1
    action59=[250,250,250,250,250,180,128,128,128,128,100, 0, 0, 0, 0, 250,250, 50,  250, 250]
#59): #// 拇指和中指掐
    action60=[160,250,150,250,250,135,128,128,128,128,70, 0, 0, 0, 0,100,250,85, 250, 250]
#60): #// 1
    action61=[250,250,250,250,250,220,128,128,128,128,100, 0, 0, 0, 0, 250, 50,250,  250, 250]
#61): #// 拇指和食指掐
    action62=[165,150,250,250,250,170,128,128,128,128,70, 0, 0, 0, 0,100,80,250, 250, 250]
#62): #// 1
    action63=[250,250,250,250,250,250,128,128,128,128,250, 0, 0, 0, 0, 250,250,250,  250, 250]
    
    # 新增：将action1到action63填充到action_group数组中
    action_group = [
        action1, action2, action3, action4, action5, action6, action7, action8, action9, action10,
        action11, action12, action13, action14, action15, action16, action17, action18, action19, action20,
        action21, action22, action23, action24, action25, action26, action27, action28, action29, action30,
        action31, action32, action33, action34, action35, action36, action37, action38, action39, action40,
        action41, action42, action43, action44, action45, action46, action47, action48, action49, action50,
        action51, action52, action53, action54, action55, action56, action57, action58, action59, action60,
        action61, action62, action63
    ]
    
    # 新增：以[1, 2, 3, ..., 63]形式创建action_time数组，便于直观查看和修改
    action_time = [
        2, 0.33, 1, 0.34, 0.34, 0.5, 0.34, 0.34, 0.34, 0.34,
        0.5, 0.5, 0.5, 0.5, 1.34, 0.34, 1, 0.5, 0.5, 0.5,
        0.5, 0.34, 0.67, 1.34, 1, 1.67, 0.34, 0.5, 0.67, 0.5,
        0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 1.34, 1.34, 1,
        1.34, 0.5, 0.5, 0.5, 0.5, 0.5, 1.67, 1.67, 0.67, 1.17,
        0.67, 1.17, 0.67, 1.34, 0.67, 1.34, 0.67, 1.17, 0.67, 1.17, 
        0.67, 1.17, 2
    ]

    poses = action_group
    count = 0
    while True:
        # 获取当前动作
        position = count % len(poses)
        current_pose = poses[position]
        current_time = action_time[position]

        if current_pose == "sleep":
            print("休眠1s")
            time.sleep(1)
            count += 1
            continue
        print(f"执行动作 {count % len(poses) + 1}: {current_pose}")
        
        # 执行动作
        hand.finger_move(pose=current_pose)
        #hand_r.finger_move(pose=current_pose)
        # 计数增加
        count += 1
        
        # 等待4秒
        time.sleep(current_time)

if __name__ == "__main__":
    main()